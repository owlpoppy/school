<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>åœ‹å°å­¸ç«¥å¤–é¡¯è¡Œç‚ºå»ºè­°ç”¢å‡ºï¼ˆå®¶é•·ï¼æ•™å¸«ï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f8fafc;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --primary: #2563eb;
      --border: #e5e7eb;
      --accent: #10b981;
    }
    html, body {
      margin: 0; padding: 0; background: var(--bg); color: var(--text); font-family: "Noto Sans TC","Microsoft JhengHei",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    .wrap {
      max-width: 1100px; margin: 24px auto; padding: 0 16px;
    }
    header {
      margin-bottom: 16px;
    }
    h1 { font-size: 24px; margin: 0 0 8px; }
    .sub { color: var(--muted); margin-bottom: 16px; }
    .card {
      background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin-bottom: 16px;
      box-shadow: 0 1px 0 rgba(0,0,0,0.02);
    }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media (max-width: 900px) { .row { grid-template-columns: 1fr; } }
    fieldset {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px 12px 8px;
      margin: 8px 0;
    }
    legend {
      padding: 0 8px; font-weight: 700; color: var(--primary);
    }
    .item { display: flex; align-items: flex-start; gap: 8px; padding: 8px; border-radius: 8px; }
    .item:hover { background: #f3f4f6; }
    .item input { margin-top: 3px; }
    .meta-row { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 12px; }
    .meta-row label { font-size: 14px; color: var(--muted); }
    .meta-row input, .meta-row select {
      border: 1px solid var(--border); border-radius: 8px; padding: 8px 10px; font-size: 14px; background: #fff; color: var(--text);
    }
    .btns { display: flex; gap: 8px; flex-wrap: wrap; }
    button {
      appearance: none; border: 1px solid var(--border); background: #fff; color: var(--text);
      padding: 10px 14px; border-radius: 10px; cursor: pointer; font-weight: 600;
    }
    button.primary { background: var(--primary); color: #fff; border-color: var(--primary); }
    button.success { background: var(--accent); color: #003b2b; border-color: var(--accent); }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    #output { white-space: normal; }
    #output h3 { margin: 8px 0 4px; }
    #output .sec { margin-top: 10px; }
    ul { margin: 6px 0 10px 20px; }
    .muted { color: var(--muted); font-size: 12px; }
    .footnote { color: var(--muted); font-size: 12px; margin-top: 8px; }
    .badge { display: inline-block; font-size: 12px; padding: 2px 8px; border-radius: 999px; background: #eef2ff; color: #3730a3; margin-left: 6px; }
    .category-title { font-weight: 700; color: #111827; margin-top: 8px; }
  </style>
  <!-- ç”¢å‡º PDFï¼ˆæ”¯æ´ä¸­æ–‡å­—ï¼‰ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js" defer></script>
  <!-- ç”¢å‡º ODTï¼ˆä½¿ç”¨ JSZip å‹•æ…‹æ‰“åŒ… ODF çµæ§‹ï¼‰ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" defer></script>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>åœ‹å°å­¸ç«¥å¤–é¡¯è¡Œç‚ºè¤‡é¸è¡¨å–® â†’ å®¶é•·ï¼æ•™å¸«å»ºè­°ç”¢å‡º</h1>
      <div class="sub">å‹¾é¸è§€å¯Ÿåˆ°çš„è¡Œç‚ºè¡¨ç¾ï¼ŒæŒ‰ã€Œç”¢ç”Ÿå»ºè­°ã€å³å¯ç”Ÿæˆå°æ‡‰ä¹‹å®¶é•·ç…§è­·å»ºè­°èˆ‡æ•™å¸«è¼”å°å»ºè­°ï¼Œä¸¦å¯åŒ¯å‡º PDFï¼ODTã€‚</div>
    </header>

    <div class="card">
      <div class="meta-row">
        <label>å­¸ç”Ÿå§“åï¼š
          <input id="studentName" placeholder="ï¼ˆé¸å¡«ï¼‰" />
        </label>
        <label>å¹´ç´šï¼š
          <select id="grade">
            <option value="">ï¼ˆé¸å¡«ï¼‰</option>
            <option>ä¸€å¹´ç´š</option><option>äºŒå¹´ç´š</option><option>ä¸‰å¹´ç´š</option>
            <option>å››å¹´ç´š</option><option>äº”å¹´ç´š</option><option>å…­å¹´ç´š</option>
          </select>
        </label>
        <label>ç­ç´šï¼š
          <input id="className" placeholder="ï¼ˆé¸å¡«ï¼‰" />
        </label>
        <label>å¡«å¯«è€…ï¼š
          <input id="author" placeholder="ï¼ˆé¸å¡«ï¼‰" />
        </label>
      </div>

      <div id="formArea" class="row" aria-live="polite"></div>

      <div class="btns" style="margin-top:12px">
        <button class="primary" id="btnGenerate">ç”¢ç”Ÿå»ºè­°</button>
        <button id="btnClear">æ¸…é™¤å‹¾é¸</button>
        <button class="success" id="btnPDF" disabled>åŒ¯å‡º PDF</button>
        <button class="success" id="btnODT" disabled>åŒ¯å‡º ODT</button>
      </div>
      <div class="footnote">æç¤ºï¼šå…ˆå‹¾é¸è¡Œç‚ºä¸¦æŒ‰ã€Œç”¢ç”Ÿå»ºè­°ã€ï¼Œå†é€²è¡ŒåŒ¯å‡ºã€‚PDF ä»¥ç‰ˆé¢å½±åƒè½‰å­˜ï¼ˆä¸­æ–‡å­—å‹å–„ï¼‰ï¼›ODT ä¾ ODF çµæ§‹ç”Ÿæˆï¼Œå¯æ–¼ LibreOffice/OpenOffice é–‹å•Ÿã€‚</div>
    </div>

    <div id="output" class="card" role="region" aria-label="å»ºè­°è¼¸å‡ºå€"></div>
  </div>

  <script>
    // åˆ†é¡èˆ‡è©³åˆ—ï¼ˆ8 é¡ï¼Œæ¯é¡ 5 æ¢ä»¥ä¸Šï¼‰
    const catalog = [
      {
        id: "A",
        name: "æ³¨æ„åŠ›èˆ‡åŸ·è¡ŒåŠŸèƒ½",
        items: [
          {
            id: "A1",
            label: "ä¸Šèª²æ˜“åˆ†å¿ƒï¼Œå¸¸åœ¨ 5 åˆ†é˜å…§æ±å¼µè¥¿æœ›æˆ–æ“…è‡ªç¿»æ‰¾æ–‡å…·ã€‚",
            parent: "åœ¨å®¶å»ºç«‹å›ºå®šå­¸ç¿’è§’è½ï¼Œæ¸›å°‘å™ªéŸ³èˆ‡ç©å…·å¹²æ“¾ï¼›ä»¥ 10â€“15 åˆ†é˜ç•ªèŒ„é˜æ­é…çŸ­æš«æ´»å‹•ä¼‘æ¯ï¼Œé€æ­¥æ‹‰é•·å°ˆæ³¨æ™‚é–“ã€‚",
            teacher: "ä½¿ç”¨åˆ†æ®µæŒ‡ä»¤èˆ‡è¦–è¦ºæç¤ºï¼ˆå¦‚å¾…è¾¦å¡ã€è¨ˆæ™‚å™¨ï¼‰ï¼›åº§ä½å®‰æ’æ–¼ä½å¹²æ“¾å€ï¼Œæä¾›ä»»å‹™æ‹†è§£å–®èˆ‡å®Œæˆæª¢æ ¸è¡¨ã€‚"
          },
          {
            id: "A2",
            label: "ä½œæ¥­å¸¸æ¼é¡Œæˆ–å°‘æ­¥é©Ÿï¼Œæª¢æ ¸è¡¨ä¹Ÿå¿˜äº†å‹¾é¸ã€‚",
            parent: "å’Œå­©å­ä¸€èµ·è¨­è¨ˆã€Œä½œæ¥­å››æ­¥é©Ÿè²¼ç´™ã€ï¼ˆè®€é¡Œâ†’åœˆé—œéµâ†’å®Œæˆâ†’æª¢æ ¸ï¼‰ï¼Œæ”¾åœ¨æ›¸æ¡Œæ˜é¡¯è™•ï¼Œå®Œæˆå¾Œä»¥è²¼ç´™å›é¥‹ã€‚",
            teacher: "æä¾›çµæ§‹åŒ–ä½œæ¥­å–®èˆ‡ç¯„ä¾‹ï¼›æ˜ç¢ºæ¨™ç¤ºæ­¥é©Ÿæ–¹å¡Šï¼Œæ”¶å·å‰ç•™ 3 åˆ†é˜çµ±ä¸€æª¢æ ¸ã€‚"
          },
          {
            id: "A3",
            label: "è½æŒ‡ä»¤éœ€è¦å¤šæ¬¡é‡è¤‡ï¼Œè¤‡æ­¥é©Ÿä»»å‹™å®¹æ˜“å¡ä½ã€‚",
            parent: "ç·´ç¿’ã€Œé‡è¿°æ­¥é©Ÿã€ï¼šè½å®Œè«‹å­©å­ç”¨è‡ªå·±çš„è©±èªªä¸€æ¬¡ï¼›å®¶ä¸­ä»»å‹™ï¼ˆæ”¶æ›¸åŒ…/æ“ºé¤å…·ï¼‰ä¹Ÿæ¡ 2â€“3 æ­¥é©Ÿé€æ­¥ç·´ç¿’ã€‚",
            teacher: "ä¸€æ¬¡çµ¦ 1â€“2 å€‹é‡é»æŒ‡ä»¤ï¼Œæ­é…æ¿æ›¸æˆ–åœ–ç¤ºï¼›å°è¤‡é›œä»»å‹™æä¾›æµç¨‹å¡ï¼Œå·¡è¦–æ™‚é»å°é»æç¤ºã€‚"
          },
          {
            id: "A4",
            label: "æ›¸åŒ…èˆ‡æŠ½å±œå‡Œäº‚ï¼Œå¸¸æ‰¾ä¸åˆ°è€ƒå·æˆ–è¯çµ¡ç°¿ã€‚",
            parent: "å›ºå®šç¡å‰ 5 åˆ†é˜æ•´ç†æ›¸åŒ…ï¼›ä½¿ç”¨åˆ†é¡å¤¾ï¼ˆä½œæ¥­/è¯çµ¡/é€šçŸ¥ï¼‰ï¼Œæ¯æ ¼è²¼ä¸Šåœ–ç¤ºæ¨™ç±¤ï¼Œå»ºç«‹ã€æ”¾å›åŸä½ã€è¦å‰‡ã€‚",
            teacher: "åœ¨æ•™å®¤è¨­ç½®æ–‡ä»¶æ”¶ç´æ ¼ï¼ŒæŒ‡å®šæ™‚é–“çµ±ä¸€æ•´ç†ï¼›æä¾›ã€Œå¸¶å›ç‰©å“æ¸…å–®ã€æ–¼æ”¾å­¸å‰å£é ­èˆ‡è¦–è¦ºé›™é‡æé†’ã€‚"
          },
          {
            id: "A5",
            label: "é ˆç­‰å¾…è¼ªæµæ™‚ç„¦èºï¼Œæ’éšŠå®¹æ˜“æ’éšŠæˆ–é›¢éšŠã€‚",
            parent: "å®¶ä¸­ç·´ç¿’ã€è¼ªæµéŠæˆ²ã€ï¼ˆéª°å­ã€UNOï¼‰ï¼Œå…ˆæ•™ç­‰å¾…æ‰‹å‹¢ï¼ˆé›™æ‰‹ç–Šæ”¾ï¼‰èˆ‡è‡ªæˆ‘æé†’èªå¥ã€‚",
            teacher: "æ•™å®¤è¨­ã€ç­‰å¾…ä»»å‹™ã€ï¼ˆæ•¸ 10 ä¸‹ã€çœ‹å€™ä½å¡ï¼‰ï¼›éŠæˆ²è¦å‰‡å…ˆæ¼”ç·´ï¼Œå°æˆåŠŸç­‰å¾…çµ¦å³æ™‚å…·é«”ç¨±è®šã€‚"
          },
          {
            id: "A6",
            label: "è€ƒè©¦æˆ–ä½œæ¥­æ™‚å®¹æ˜“è¢«å°å™ªéŸ³æ‹‰èµ°æ³¨æ„åŠ›ã€‚",
            parent: "æº–å‚™ç°¡æ˜“é™å™ªè€³ç½©æˆ–è€³å¡æ–¼è‡ªç¿’æ™‚æ®µï¼›ä»¥ç™½å™ªéŸ³/è‡ªç„¶éŸ³é™ªä¼´é–±è®€ï¼Œé€æ­¥æ¸›å°‘ä¾è³´ã€‚",
            teacher: "å®‰æ’ä½å¹²æ“¾åº§ä½ã€å…è¨±ä½¿ç”¨å®‰éœå°ç‰©ï¼›è€ƒè©¦æ™‚æä¾›éš”æ¿æˆ–å‰å¾ŒéŒ¯ä½åº§ã€‚"
          }
        ]
      },
      {
        id: "B",
        name: "æƒ…ç·’èª¿ç¯€èˆ‡ç„¦æ…®",
        items: [
          {
            id: "B1",
            label: "å°æŒ«æŠ˜å°±å“­æ³£æˆ–ç”Ÿæ°£ï¼Œæƒ…ç·’æ¢å¾©æ™‚é–“è¼ƒé•·ã€‚",
            parent: "é™ªç·´æƒ…ç·’å‘½åèˆ‡ 4-7-8 å‘¼å¸ï¼›å…ˆå…±æ„Ÿå†å¼•å°ã€ä¸‹ä¸€æ­¥å¯ä»¥æ€éº¼åšã€ï¼Œæº–å‚™å®‰éœè§’è½èˆ‡èˆ’ç·©ç‰©ï¼ˆçƒã€æŠ±æ•ï¼‰ã€‚",
            teacher: "èª²å ‚è¨­ã€æƒ…ç·’æº«åº¦è¨ˆã€èˆ‡ 2â€“3 å€‹å†·éœç­–ç•¥æµ·å ±ï¼›å…è¨±çŸ­æš«ç§»å‹•åˆ°å†·éœå€ï¼Œå›åˆ°åº§ä½å†å®Œæˆä»»å‹™ã€‚"
          },
          {
            id: "B2",
            label: "æ¸¬é©—å‰å‡ºç¾è‚šå­ç—›ã€é ­ç—›ç­‰èº«é«”ä¸é©è¨´æ±‚ã€‚",
            parent: "å»ºç«‹è€ƒå‰æµç¨‹ï¼ˆé ç¿’â†’å°æ¸¬â†’æ”¾é¬†ï¼‰ï¼›æ•™æˆè…¹å¼å‘¼å¸èˆ‡è‚Œè‚‰æ”¾é¬†ï¼›ä»¥å°å¹…åº¦ã€å¸¸æ…‹åŒ–æª¢æ ¸æ¸›å°‘å¨è„…æ„Ÿã€‚",
            teacher: "æ¸¬é©—è¦æ¨¡å‰ç½®èªªæ˜èˆ‡ç¯„ä¾‹ï¼›å®‰æ’æš–èº«é¡Œèˆ‡å½ˆæ€§æ™‚é–“ï¼›è©•é‡å¤šå…ƒåŒ–ï¼Œå¼·èª¿éç¨‹èˆ‡ç­–ç•¥ã€‚"
          },
          {
            id: "B3",
            label: "å®¹æ˜“æ“”å¿ƒçŠ¯éŒ¯ï¼Œä¸æ•¢å˜—è©¦æ–°æ´»å‹•æˆ–å›ç­”ã€‚",
            parent: "åˆ»æ„ç·´ç¿’ã€å°æŒ‘æˆ°ã€ï¼ŒéŒ¯èª¤è¦–ç‚ºå­¸ç¿’è³‡è¨Šï¼›ä»¥åŠªåŠ›èˆ‡ç­–ç•¥çµ¦äºˆæ­£å‘å›é¥‹ï¼Œä¸å°‡çµæœè²¼æ¨™ç±¤ã€‚",
            teacher: "å»ºç«‹ã€éŒ¯èª¤å‹å–„ã€æ–‡åŒ–ï¼ˆæœ¬é€±æœ€ä½³ä¿®æ­£ï¼‰ï¼›æ¡ç”¨ä½é¢¨éšªå›ç­”ï¼ˆå°ç™½æ¿/åŒå„•è¨è«–å¾Œç™¼è¡¨ï¼‰ã€‚"
          },
          {
            id: "B4",
            label: "å—åˆ°æé†’å°±è‡ªè²¬ï¼Œå°è‡ªæˆ‘è©•åƒ¹åä½ã€‚",
            parent: "æ¯å¤©è¨˜éŒ„ 1 ä»¶åšå¾—å¥½çš„å°äº‹ï¼›ç¤ºç¯„æŠŠè¡Œç‚ºèˆ‡äººåˆ†é–‹è©•è«–ï¼Œé¿å…å…¨æœ‰å…¨ç„¡èªå¥ã€‚",
            teacher: "å›é¥‹èšç„¦è¡Œç‚ºèˆ‡ç­–ç•¥ï¼Œä¸è²¼æ¨™ï¼›æä¾›é€²æ­¥è­‰æ“šï¼ˆå‰å¾Œå°ç…§ï¼‰ï¼Œå¼•å°è‡ªæˆ‘è‚¯å®šå¥ã€‚"
          },
          {
            id: "B5",
            label: "å°å™ªéŸ³æˆ–æ“æ“ ç’°å¢ƒæ˜é¡¯ä¸è€ï¼Œæ˜“çˆ†è¡ã€‚",
            parent: "å¤–å‡ºå‰å…ˆé å‘Šç’°å¢ƒèˆ‡é€€å ´è¨ˆç•«ï¼›æ”œå¸¶èˆ’ç·©å°ç‰©ï¼ˆè€³ç½©ã€ææçƒï¼‰ï¼Œäº‹å¾Œå›é¡§æˆåŠŸç‰‡æ®µã€‚",
            teacher: "èµ°å»Šæ’éšŠæ¡åˆ†æµèˆ‡æ˜ç¢ºéšŠå½¢ï¼›æ´»å‹•å‰å»ºç«‹ã€å¤ªåµæ™‚æˆ‘å¯ä»¥â€¦ã€æ›¿ä»£è¡Œç‚ºæ¸…å–®ã€‚"
          }
        ]
      },
      {
        id: "C",
        name: "äººéš›äº’å‹•èˆ‡ç¤¾äº¤æŠ€å·§",
        items: [
          {
            id: "C1",
            label: "ä¸‹èª²å¤šç¨è™•ï¼Œå°åŒå„•é‚€è«‹åæ‡‰é²ç–‘æˆ–æ‹’çµ•ã€‚",
            parent: "å”åŠ©æ¼”ç·´é–‹å ´èªèˆ‡åŠ å…¥éŠæˆ²å¥å‹ï¼›å®‰æ’ 1 å° 1 å°å‹åŒå„•äº’å‹•ï¼Œå…ˆå¾ç†Ÿæ‚‰æ´»å‹•é–‹å§‹ã€‚",
            teacher: "è¨­è¨ˆçµæ§‹åŒ–åˆä½œä»»å‹™ï¼Œåˆ†æ´¾æ˜ç¢ºè§’è‰²ï¼›æŒ‡å®šåŒå„•å°å¹«æ‰‹ï¼Œé€æ­¥æ“´å¤§ç¤¾äº¤åœˆã€‚"
          },
          {
            id: "C2",
            label: "å°ç©ç¬‘ç¼ºä¹åˆ†è¾¨ï¼Œå®¹æ˜“èª¤è§£ç‚ºæƒ¡æ„ã€‚",
            parent: "ç”¨ç¹ªæœ¬æˆ–å½±ç‰‡ç¤ºä¾‹ã€ç©ç¬‘/æƒ¡æ„ã€å·®ç•°ï¼›ç·´ç¿’é‡åˆ°ä¸ç¢ºå®šæ™‚è©¢å•æ¾„æ¸…çš„å¥å‹ã€‚",
            teacher: "æ•™æˆç¤¾äº¤ç·šç´¢ï¼ˆè¡¨æƒ…ã€èªæ°£ï¼‰ï¼Œå®‰æ’è§’è‰²æ‰®æ¼”ï¼›é‡èª¤æœƒæ™‚åšå³æ™‚ç¤ºç¯„æ€§èª¿è§£ã€‚"
          },
          {
            id: "C3",
            label: "éŠæˆ²è¦å‰‡è«‡ä¸æ”å³çˆ­åŸ·ï¼Œæ¬ ç¼ºå”å•†ã€‚",
            parent: "å®¶åº­éŠæˆ²å‰å…ˆå¯«ä¸‹ã€å¤§å®¶éƒ½åŒæ„çš„ 3 æ¢è¦å‰‡ã€ï¼ŒçµæŸå¾Œä¸€èµ·å›é¡§èª¿æ•´ã€‚",
            teacher: "åˆä½œå­¸ç¿’åŠ å…¥ã€å”å•†æ™‚é–“ã€èˆ‡æŠ•ç¥¨æ©Ÿåˆ¶ï¼›å¼·åŒ–ã€å…ˆèªªæˆ‘æƒ³æ³•ï¼Œå†è½ä½ æƒ³æ³•ã€æ­¥é©Ÿã€‚"
          },
          {
            id: "C4",
            label: "èªæ°£éæ–¼ç›´æ¥ï¼Œå¿½ç•¥å°æ–¹æ„Ÿå—ã€‚",
            parent: "ç¤ºç¯„ã€æˆ‘è¨Šæ¯ã€å¥å‹ï¼ˆæˆ‘è¦ºå¾—â€¦å› ç‚ºâ€¦æˆ‘å¸Œæœ›â€¦ï¼‰ï¼›ç·´ç¿’å…ˆæè¿°äº‹å¯¦å†è¡¨é”æ„Ÿå—ã€‚",
            teacher: "å»ºç«‹å›é¥‹å¥å‹ç‰†ï¼›å°è‰¯å¥½èªæ°£å³æ™‚æ¨™è¨»èˆ‡ç¨±è®šï¼Œå¿…è¦æ™‚æä¾›é‡è¿°æ©Ÿæœƒã€‚"
          },
          {
            id: "C5",
            label: "é‡è¡çªæ™‚ç¿’æ–¼é€ƒé¿æˆ–éåº¦é“æ­‰ã€‚",
            parent: "ç”¨è¡çªåœ°åœ–å›é¡§äº‹ä»¶ï¼Œæ‰¾ 1 å€‹å¯æ§çš„ä¸‹ä¸€æ­¥ï¼›ç·´ç¿’æœ‰ç•Œç·šçš„é“æ­‰èˆ‡è£œæ•‘è¡Œå‹•ã€‚",
            teacher: "å¼•å°ä¸‰æ®µå¼å¾©åŸï¼ˆèªªå‡ºäº‹å¯¦â†’è¡¨é”æ„Ÿå—â†’æå‡ºä¿®å¾©ï¼‰ï¼›æä¾›å®‰å…¨ç™¼è²ç®¡é“ï¼ˆä¾¿æ¢ã€ç§èŠï¼‰ã€‚"
          }
        ]
      },
      {
        id: "D",
        name: "è¦ç¯„éµå®ˆèˆ‡è¡å‹•è¡Œç‚º",
        items: [
          {
            id: "D1",
            label: "ä¸Šèª²è„«å£è€Œå‡ºï¼Œæœªèˆ‰æ‰‹å…ˆç™¼è¨€ã€‚",
            parent: "å®¶ä¸­ç·´ç¿’èˆ‰æ‰‹ç­‰å¾… 3 ç§’çš„è¦å‰‡éŠæˆ²ï¼›æˆåŠŸè‡ªæ§æ™‚çµ¦å‡ºå³æ™‚å…·é«”è‚¯å®šã€‚",
            teacher: "è¦–è¦ºåŒ–ã€ç™¼è¨€ä¸‰æ­¥ã€ï¼›å®‰æ’å¿«é€Ÿæå•æ¿ï¼ˆå¯«å¥½èˆ‰ç‰Œï¼‰ï¼Œé™ä½æ’å˜´è¡å‹•ã€‚"
          },
          {
            id: "D2",
            label: "é›£ä»¥åå®šï¼Œç¶“å¸¸æ–æ™ƒæ¤…å­æˆ–é›¢åº§èµ°å‹•ã€‚",
            parent: "è¦å¾‹æˆ¶å¤–æ´»å‹•æ¶ˆè€—é«”èƒ½ï¼›å­¸ç¿’æ™‚æ®µæä¾›å¯æŒ‰å£“å°ç‰©æˆ–åå¢Šï¼Œå®‰æ’çŸ­æš«ç§»å‹•ä»»å‹™ã€‚",
            teacher: "å½ˆæ€§åº§ä½èˆ‡ç«™ç«‹æ¡Œï¼Œèª²ä¸­åŠ å…¥å¾®å‹•ä½œï¼ˆå‚³éç‰©ã€æ“¦ç™½æ¿ï¼‰ï¼Œä»¥ä»»å‹™å°å‘æ›¿ä»£é›¢åº§ã€‚"
          },
          {
            id: "D3",
            label: "ä½œæ¯èˆ‡è¦å®šè®Šå‹•æ™‚æƒ…ç·’æ³¢å‹•å¤§ã€‚",
            parent: "å‰ä¸€æ™šé å‘Šéš”æ—¥æµç¨‹ï¼›ç”¨è¦–è¦ºè¡Œäº‹æ›†æ¨™è¨»è®Šå‹•ï¼Œé‡è‡¨æ™‚è®Šå‹•çµ¦å…·é«”é¸é …ã€‚",
            teacher: "åœ¨é»‘æ¿é å…ˆå…¬å‘Šç•¶æ—¥ç¯€ç›®è¡¨ï¼›æ´»å‹•è½‰æ›å‰å£é ­+è¦–è¦ºå€’æ•¸ï¼Œæä¾›éæ¸¡ä»»å‹™ã€‚"
          },
          {
            id: "D4",
            label: "å€‰ä¿ƒäº¤å·ä¸æª¢æŸ¥ï¼Œåªæ±‚å¿«å®Œæˆã€‚",
            parent: "å»ºç«‹ã€å®Œæˆâ†’æª¢æŸ¥â†’é€å‡ºã€ä¸‰æ­¥å„€å¼ï¼›æª¢æŸ¥å®Œæˆæ‰å¯é€²å…¥ä¸‹ä¸€å€‹å–œæ­¡æ´»å‹•ã€‚",
            teacher: "è€ƒå·ä¸ŠåŠ ã€æª¢æŸ¥æ ¼ã€ï¼Œè¨­ 3 åˆ†é˜æª¢æ ¸æ™‚é–“ï¼›ç¤ºç¯„å¦‚ä½•æª¢æŸ¥ä¸¦æ¼”ç·´è‡ªè©•ã€‚"
          },
          {
            id: "D5",
            label: "å–œæ­¡é€å¿«ï¼Œæˆ¶å¤–æ´»å‹•æœ‰è¡æ’æˆ–å±éšªè¡Œç‚ºã€‚",
            parent: "æ˜è¨‚å…¬åœ’å®‰å…¨è¦ç¯„èˆ‡å¯æ›¿ä»£æŒ‘æˆ°ï¼ˆè¨ˆæ­¥ã€å®šé»è¡åˆºï¼‰ï¼›äº‹å‰ç´„å®šåœæè¨Šè™Ÿã€‚",
            teacher: "é«”è‚²èª²å…ˆç¤ºç¯„å®‰å…¨å‹•ç·šèˆ‡ç¢°æ’è¦å‰‡ï¼›çµ¦ã€é€Ÿåº¦æŒ‘æˆ°ã€ä½†è¨­è¨ˆå®‰å…¨æª¢æ ¸é»ã€‚"
          }
        ]
      },
      {
        id: "E",
        name: "å­¸ç¿’å‹•æ©Ÿèˆ‡ç­–ç•¥",
        items: [
          {
            id: "E1",
            label: "é¢å°é•·æ–‡æœ¬é–±è®€å®¹æ˜“æ”¾ç©ºï¼Œä¸åšç­†è¨˜ã€‚",
            parent: "å…±è®€æ™‚ç¤ºç¯„ç•«é‡é»èˆ‡é‚Šè®€é‚Šå•ï¼›ç”¨çŸ­æ®µè½åˆ†æ®µé”æ¨™ï¼Œå°çå‹µå¼·åŒ–æŒçºŒæ€§ã€‚",
            teacher: "æ•™æˆ SQ3R/åŠƒè¨˜ç­–ç•¥ï¼›æä¾›å¯è¤‡è£½çš„é‡é»ç­†è¨˜ç¯„ä¾‹ï¼Œæ¼¸é€²è¦æ±‚ç¨ç«‹å®Œæˆã€‚"
          },
          {
            id: "E2",
            label: "å®¶åº­ä½œæ¥­æ‹–å»¶åˆ°å¾ˆæ™šæ‰é–‹å§‹æˆ–å®Œæˆã€‚",
            parent: "å›ºå®šæ™‚é–“èˆ‡åœ°é»å•Ÿå‹•ä½œæ¥­ï¼Œä½¿ç”¨ 10â€“15 åˆ†é˜è¨ˆæ™‚æ­é…çŸ­ä¼‘æ¯ï¼›å…ˆåšå®¹æ˜“çš„æå‡å‹•èƒ½ã€‚",
            teacher: "æ‹†åˆ†ä½œæ¥­ä»½é‡èˆ‡æ¸…æ™°æœŸé™ï¼›æä¾›ä½œæ¥­å•Ÿå‹•æç¤ºï¼Œå›æ”¶æ™‚å›é¥‹æ™‚é–“ç®¡ç†æˆæ•ˆã€‚"
          },
          {
            id: "E3",
            label: "å°éèˆˆè¶£ç§‘ç›®ç¼ºä¹æŠ•å…¥ï¼Œå®¹æ˜“èªªã€Œæˆ‘ä¸æœƒã€ã€‚",
            parent: "æŠŠä»»å‹™æ”¹ç‚ºå¯é¸é¡Œæˆ–ç”Ÿæ´»æƒ…å¢ƒåŒ–ï¼›ä»¥éç¨‹å°å‘ç¨±è®šã€ä½ å˜—è©¦äº†æ–°æ–¹æ³•ã€ã€‚",
            teacher: "å·®ç•°åŒ–ä»»å‹™èˆ‡å¤šå…ƒè¡¨é”ï¼ˆåœ–ã€å£èªªã€æ“ä½œï¼‰ï¼›è¨­å®šå¯é”æˆçš„å°ç›®æ¨™èˆ‡å›é¥‹ç¯€é»ã€‚"
          },
          {
            id: "E4",
            label: "ç¼ºä¹ç›®æ¨™è¨­å®šï¼Œä¸æ¸…æ¥šæˆåŠŸæ¨™æº–ã€‚",
            parent: "æ¯é€±èˆ‡å­©å­è¨‚ 1â€“2 å€‹å…·é«”ã€å¯è¡¡é‡çš„å°ç›®æ¨™ï¼›ç”¨é€²åº¦è¡¨å¯è¦–åŒ–æˆæœã€‚",
            teacher: "åœ¨ä»»å‹™å‰æ˜ç¤ºæˆåŠŸæ¨™æº–èˆ‡ç¯„ä¾‹ï¼›ä»¥å­¸ç¿’å–®å¼•å°è‡ªè¨‚ç›®æ¨™èˆ‡è‡ªè©•åæ€ã€‚"
          },
          {
            id: "E5",
            label: "è‡ªä¸»å­¸ç¿’æ™‚é–“çŸ­ï¼Œé ˆæˆäººå¤šæ¬¡æé†’ã€‚",
            parent: "ç”¨è¦–è¦ºè¨ˆæ™‚å™¨èˆ‡å¾…è¾¦æ¸…å–®ï¼›å®Œæˆæ¯ä¸€æ­¥çµ¦å£é ­è‚¯å®šï¼Œé€æ­¥å»¶é•·è‡ªä¸»æ™‚æ®µã€‚",
            teacher: "èª²å ‚å®‰æ’ã€å®‰éœå·¥ä½œæ™‚æ®µã€èˆ‡åº§ä½å·¡è¦–ï¼›ä»¥å®Œæˆæ¸…å–®èˆ‡åŒå„•äº’æŸ¥æå‡è‡ªå¾‹ã€‚"
          }
        ]
      },
      {
        id: "F",
        name: "æ„Ÿè¦ºæ•æ„Ÿèˆ‡èº«é«”å‹•ä½œ",
        items: [
          {
            id: "F1",
            label: "å°è¡£æ¨™ã€å£ç½©æˆ–è¥ªå­ç¸«ç·šæ„Ÿåˆ°åˆºç™¢ç…©èºã€‚",
            parent: "é¸æ“‡æŸ”è»Ÿæè³ªã€å‰ªå»æ¨™ç±¤ï¼›å¤–å‡ºå‰å…ˆè©¦ç©¿ï¼Œæä¾›å¯æ›¿æ›çš„èˆ’é©å‚™å“ã€‚",
            teacher: "å…è¨±çŸ­æš«æ•´ç†è¡£ç‰©æˆ–æ›´æ›å£ç½©ï¼›åº§ä½å®‰æ’é¿å…æ—¥ç…§ç›´å°„æˆ–ç©ºèª¿ç›´å¹ã€‚"
          },
          {
            id: "F2",
            label: "å°å°è²éŸ³ä¹Ÿåˆ†å¿ƒï¼Œå¦‚é‰›ç­†æ‘©æ“¦æˆ–æ‰“å­—è²ã€‚",
            parent: "åœ¨å®¶è‡ªç¿’å¯ç”¨ç™½å™ªéŸ³ï¼›é€æ­¥æš´éœ²èˆ‡ç·´ç¿’å°ˆæ³¨ä»»å‹™ï¼Œå»ºç«‹è‡ªæˆ‘å°è©±æé†’ã€‚",
            teacher: "å®‰æ’ä½å™ªå€ï¼›å…è¨±ä½¿ç”¨å®‰éœå·¥å…·ï¼ˆè»Ÿå¢Šã€è€³ç½©ï¼‰ï¼Œç¤ºç¯„å¦‚ä½•è‡ªæˆ‘èª¿æ•´åº§ä½ã€‚"
          },
          {
            id: "F3",
            label: "å–œæ­¡ç”¨åŠ›å¥”è·‘ã€æ’é æ¡Œæ¤…å°‹æ±‚åˆºæ¿€ã€‚",
            parent: "æ¯æ—¥å®‰æ’å¤§è‚Œè‚‰æ´»å‹•ï¼ˆè·‘è·³ã€çƒé¡ï¼‰ï¼›åœ¨å®¶æä¾›æ“ å£“æŠ±æ•æˆ–å½ˆåŠ›å¸¶ã€‚",
            teacher: "èª²å‰æš–èº«åŠ å…¥æ·±å£“æˆ–æ¨æ‹‰æ´»å‹•ï¼›æä¾›ã€åŠ›é‡ä»»å‹™ã€ä»¥å®‰å…¨æ–¹å¼æ»¿è¶³æ„Ÿè¦ºéœ€æ±‚ã€‚"
          },
          {
            id: "F4",
            label: "æ›¸å¯«ç”¨åŠ›éå¤§æˆ–éå°ï¼Œå­—è·ä¸ç©©ã€‚",
            parent: "ä½¿ç”¨ç²—ç´°åˆé©çš„ç­†èˆ‡æ»‘é †ç´™å¼µï¼›å…ˆåšæ‰‹éƒ¨ç²¾ç´°å‹•ä½œéŠæˆ²ï¼ˆå¤¾ç ã€æé»åœŸï¼‰ã€‚",
            teacher: "æä¾›å­—æ¡†èˆ‡è¡Œè·è¼”åŠ©ç´™ï¼›ç¤ºç¯„æ¡ç­†å§¿å‹¢èˆ‡ç¯€å¥ï¼Œåˆ†æ®µç·´ç¿’å†æ•´ç¯‡ã€‚"
          },
          {
            id: "F5",
            label: "é«”è‚²èª²æ›æ´»å‹•éæ¸¡éœ€è¦è¼ƒå¤šæ™‚é–“é©æ‡‰ã€‚",
            parent: "å‡ºé–€å‰é å‘Šæ´»å‹•æµç¨‹èˆ‡è¦å‰‡ï¼›å›å®¶å¾Œå›é¡§æˆåŠŸä¹‹è™•ä¸¦è¨­å®šä¸‹ä¸€æ¬¡å˜—è©¦é»ã€‚",
            teacher: "æ´»å‹•åˆ‡æ›å‰å£é ­+è¦–è¦ºå€’æ•¸ï¼›çµ¦ã€å…ˆè§€å¯Ÿå¾Œåƒèˆ‡ã€é¸é …ï¼Œé™ä½ä¸ç¢ºå®šæ„Ÿã€‚"
          }
        ]
      },
      {
        id: "G",
        name: "èªè¨€è¡¨é”èˆ‡ç†è§£",
        items: [
          {
            id: "G1",
            label: "å£é ­è¡¨é”ç¹åœˆï¼Œé‡é»ä¸æ¸…ï¼Œé›£ä»¥èªªå®Œã€‚",
            parent: "ä»¥ã€é–‹é ­-é‡é»-çµå°¾ã€å¡ç‰‡ç·´ç¿’èªªæ•…äº‹ï¼›å®¶ä¸­å°è«‡å…ˆçµ¦ 1 åˆ†é˜èªªè©±æ™‚é–“ã€‚",
            teacher: "å£é ­ç™¼è¡¨å‰æä¾›æç¶±æ¨¡æ¿ï¼›åŒå„•äº’è©•èšç„¦ã€æ˜¯å¦æŠ“åˆ°é‡é»ã€ã€‚"
          },
          {
            id: "G2",
            label: "æ¥æ”¶æŒ‡ä»¤æŠ“ä¸åˆ°é—œéµå­—ï¼Œéœ€è¦æ‹†è§£ã€‚",
            parent: "åœ¨å®¶å°‡å®¶å‹™æ‹†ç‚º 2â€“3 æ­¥é©Ÿä¸¦è«‹å­©å­é‡è¿°ï¼›çµ¦äºˆè¦–è¦ºåŒ–æ­¥é©Ÿå¡ã€‚",
            teacher: "æ•™å®¤æŒ‡ä»¤æ¡ã€å‹•è©+å°è±¡+æ¢ä»¶ã€æ ¼å¼ä¸¦æ¿æ›¸ï¼›è«‹å­¸ç”Ÿå›èªªä¸€æ¬¡ç¢ºèªç†è§£ã€‚"
          },
          {
            id: "G3",
            label: "å£èªè©å½™æœ‰é™ï¼Œå®¹æ˜“ç”¨ã€Œé‚£å€‹ã€ã€Œé€™å€‹ã€ä»£ç¨±ã€‚",
            parent: "é€éç¹ªæœ¬æ“´å……ä¸»é¡Œè©å½™ï¼›ç©ã€æ‰¾åŒç¾©è©ã€èˆ‡ã€èªªæ˜ç‰©å“ä¸‰ç‰¹å¾µã€éŠæˆ²ã€‚",
            teacher: "åœ¨å–®å…ƒå»ºç«‹è©å½™ç‰†ï¼›å£èªªä»»å‹™å…è¨±å…ˆå¯«é—œéµå­—å†è¡¨é”ã€‚"
          },
          {
            id: "G4",
            label: "æ•…äº‹é‡è¿°æ™‚å¿½ç•¥æ™‚é–“é †åºèˆ‡å› æœã€‚",
            parent: "ç”¨æ™‚é–“ç·šè²¼ç´™æ’é †åºï¼›ç·´ç¿’ã€å› ç‚ºâ€¦æ‰€ä»¥â€¦ã€å¥å‹é€ å¥ã€‚",
            teacher: "æä¾›æƒ…ç¯€å¡é‡çµ„æ´»å‹•ï¼›å£é ­å›è¿°ä»¥æç¤ºè©å¼•å°ï¼ˆé¦–å…ˆ/æ¥è‘—/æœ€å¾Œï¼‰ã€‚"
          },
          {
            id: "G5",
            label: "èˆ‡å¸«é•·å°è«‡æ™‚é¿å…çœ¼ç¥æ¥è§¸ã€‚",
            parent: "å…è¨±ä»¥çœ‹é¼»æ¨‘æˆ–çœ‰å¿ƒä»£æ›¿ç›´è¦–ï¼›å…ˆç”¨çŸ­å¥ç·´ç¿’é€æ­¥å»¶é•·å°è©±æ™‚é–“ã€‚",
            teacher: "æ¥ç´å¤šæ¨£ç¤¾äº¤è¡¨ç¾ï¼Œä¸å¼·è¿«ç›´è¦–ï¼›çµ¦æ˜ç¢ºè¼ªæ›¿æç¤ºï¼Œé™ä½ç¤¾äº¤å£“åŠ›ã€‚"
          }
        ]
      },
      {
        id: "H",
        name: "è‡ªæˆ‘æ¦‚å¿µèˆ‡è‡ªæˆ‘ç®¡ç†",
        items: [
          {
            id: "H1",
            label: "å®¹æ˜“ç”¨è² é¢æ¨™ç±¤å½¢å®¹è‡ªå·±ï¼Œå¦‚ã€Œæˆ‘æœ€å·®ã€ã€‚",
            parent: "æ¯å¤©å¯«ä¸‹ 1 ä»¶å®Œæˆçš„å°äº‹ï¼›èˆ‡å­©å­ä¸€èµ·ä¿®æ­£è² å‘èªå¥ç‚ºä¸­æ€§äº‹å¯¦èˆ‡è¡Œå‹•è¨ˆç•«ã€‚",
            teacher: "å›é¥‹èšç„¦åŠªåŠ›èˆ‡ç­–ç•¥ï¼Œå±•ç¤ºé€²æ­¥æ›²ç·šï¼›å»ºç«‹ã€æœ¬é€±äº®é»ã€æ¬„ä½è®“å­¸ç”Ÿä¸Šç‰†ã€‚"
          },
          {
            id: "H2",
            label: "æˆå°±æ­¸å› æ–¼é‹æ°£ï¼ŒæŒ«æŠ˜æ­¸å› æ–¼èƒ½åŠ›ä¸è¶³ã€‚",
            parent: "å¸¶å­©å­å›é¡§æˆåŠŸçš„åŠªåŠ›æ­¥é©Ÿï¼›è¨­å®šå¯æ§ç›®æ¨™èˆ‡ä¸‹ä¸€æ­¥è¡Œå‹•ï¼Œæ¸›å°‘èƒ½åŠ›å®šå‹èªå¥ã€‚",
            teacher: "ç¤ºç¯„ã€æˆé•·å‹æ€ç¶­ã€èªè¨€ï¼›ä»¥æ­·ç¨‹è©•é‡ç´€éŒ„å­¸ç”ŸæŠ•å…¥èˆ‡ç­–ç•¥é‹ç”¨ã€‚"
          },
          {
            id: "H3",
            label: "ç„¡æ³•è­˜åˆ¥è‡ªå·±çš„æƒ…ç·’èˆ‡èº«é«”æ„Ÿå—ã€‚",
            parent: "ä½¿ç”¨æƒ…ç·’è¼ªæˆ–è¡¨æƒ…å¡æ¯æ—¥æ‰“å¡ï¼›é€£çµèº«é«”è¨Šè™Ÿèˆ‡æƒ…ç·’ï¼ˆå¿ƒè·³å¿«â†’å¯èƒ½ç„¦æ…®ï¼‰ã€‚",
            teacher: "èª²è¡¨ä¸­èå…¥æƒ…ç·’æª¢è¦– 1 åˆ†é˜ï¼›å¼•å°ç”¨æƒ…ç·’è©èˆ‡éœ€æ±‚è©è¡¨é”ã€‚"
          },
          {
            id: "H4",
            label: "å¿˜è¨˜å¸¶ç”¨å“æˆ–æœªä¾è¯çµ¡ç°¿æº–å‚™ç‰©å“ã€‚",
            parent: "ç¡å‰ä¾ã€å¸¶æ±è¥¿æ¸…å–®ã€æª¢æŸ¥ï¼›ç‰©å“å›ºå®šæ”¶ç´ä½ç½®èˆ‡é¡è‰²æ¨™ç±¤ã€‚",
            teacher: "æ”¾å­¸å‰ç•™ 5 åˆ†é˜æª¢æŸ¥è¯çµ¡ç°¿ï¼›è¨­ç½®ã€å‚™ç”¨å“å€Ÿç”¨ç®±ã€èˆ‡æ­¸é‚„ç´€éŒ„ã€‚"
          },
          {
            id: "H5",
            label: "å°éŒ¯èª¤æ€•è¢«ç¬‘ï¼Œå‚¾å‘èº²é¿è¡¨ç¾æ©Ÿæœƒã€‚",
            parent: "ä»¥å®¶åº­åˆ†äº«æœƒç·´ç¿’å®‰å…¨è¡¨é”ï¼›å…ˆè®šè¨±å‹‡æ°£èˆ‡å˜—è©¦ï¼Œå†è«‡ä¿®æ­£æ–¹å‘ã€‚",
            teacher: "å»ºç«‹å®‰å…¨ç™¼è¡¨è¦å‰‡èˆ‡é¼“å‹µå¥ï¼›æä¾›å…ˆå°çµ„å¾Œå…¨ç­çš„æ¼¸é€²å¼ç™¼è¡¨éšæ¢¯ã€‚"
          }
        ]
      }
    ];

    // å°‡ catalog æ¸²æŸ“ç‚ºè¡¨å–®
    function renderForm() {
      const area = document.getElementById("formArea");
      area.innerHTML = "";
      catalog.forEach((cat) => {
        const fs = document.createElement("fieldset");
        const legend = document.createElement("legend");
        legend.textContent = cat.name;
        fs.appendChild(legend);

        cat.items.forEach((it) => {
          const div = document.createElement("div");
          div.className = "item";
          const id = `chk_${cat.id}_${it.id}`;
          div.innerHTML = `
            <input type="checkbox" id="${id}" data-cat="${cat.id}" data-item="${it.id}">
            <label for="${id}">${it.label}</label>
          `;
          fs.appendChild(div);
        });

        area.appendChild(fs);
      });
    }

    function getSelected() {
      const checked = Array.from(document.querySelectorAll('#formArea input[type="checkbox"]:checked'));
      const selected = [];
      checked.forEach(chk => {
        const catId = chk.getAttribute("data-cat");
        const itemId = chk.getAttribute("data-item");
        const cat = catalog.find(c => c.id === catId);
        if (!cat) return;
        const item = cat.items.find(i => i.id === itemId);
        if (!item) return;
        selected.push({
          category: cat.name,
          label: item.label,
          parent: item.parent,
          teacher: item.teacher
        });
      });
      return selected;
    }

    function formatHeaderLine() {
      const name = document.getElementById("studentName").value?.trim() || "ï¼ˆæœªå¡«ï¼‰";
      const grade = document.getElementById("grade").value || "ï¼ˆæœªå¡«ï¼‰";
      const cls = document.getElementById("className").value?.trim() || "ï¼ˆæœªå¡«ï¼‰";
      const author = document.getElementById("author").value?.trim() || "ï¼ˆæœªå¡«ï¼‰";
      const ts = new Date();
      const yyyy = ts.getFullYear();
      const mm = String(ts.getMonth()+1).padStart(2,"0");
      const dd = String(ts.getDate()).padStart(2,"0");
      const hh = String(ts.getHours()).padStart(2,"0");
      const min = String(ts.getMinutes()).padStart(2,"0");
      return {
        human: `å­¸ç”Ÿï¼š${name}ã€€å¹´ç´šï¼š${grade}ã€€ç­ç´šï¼š${cls}ã€€å¡«å¯«è€…ï¼š${author}ã€€æ—¥æœŸï¼š${yyyy}-${mm}-${dd} ${hh}:${min}`,
        meta: { name, grade, cls, author, date: `${yyyy}-${mm}-${dd} ${hh}:${min}` }
      };
    }

    function generateOutput() {
      const selected = getSelected();
      const out = document.getElementById("output");
      if (selected.length === 0) {
        out.innerHTML = "<div class='muted'>å°šæœªå‹¾é¸ä»»ä½•è¡Œç‚ºã€‚è«‹è‡³å°‘é¸æ“‡ä¸€é …å¾Œå†ç”¢ç”Ÿå»ºè­°ã€‚</div>";
        document.getElementById("btnPDF").disabled = true;
        document.getElementById("btnODT").disabled = true;
        return;
      }
      const header = formatHeaderLine();

      // ä¾ã€Œå®¶é•·ï¼æ•™å¸«ã€åˆ†çµ„
      const parentList = selected.map(s => `<li><span class="category-title">[${s.category}]</span> ${s.label}<br>å»ºè­°ï¼š${s.parent}</li>`).join("");
      const teacherList = selected.map(s => `<li><span class="category-title">[${s.category}]</span> ${s.label}<br>å»ºè­°ï¼š${s.teacher}</li>`).join("");

      out.innerHTML = `
        <div>
          <h2>å­¸ç«¥ç…§è­·èˆ‡æ•™å­¸å»ºè­°</h2>
          <div class="muted">${header.human}</div>
          <div class="sec">
            <h3>ğŸ“Œ å®¶é•·ç…§è­·å»ºè­° <span class="badge">å…± ${selected.length} æ¢</span></h3>
            <ul>${parentList}</ul>
          </div>
h3>ğŸ“Œ å®¶é•·ç…§è­·å»ºè­° <span class="badge">å…± ${selected.length} æ¢</span></h3>
            <ul>${parentList}</ul>
          </div>
          <div class="sec">
                     <div class="sec">
            <h3>ğŸ“˜ æ•™å¸«è¼”å°å»ºè­° < <h3>ğŸ“˜ æ•™å¸«è¼”å°å»ºè­° <span class="badgespan class="badge">å…± ${selected.length">å…± ${selected.length} æ¢</span></h3>
            <ul>${} æ¢</span></h3>
            <ul>${teacherList}</ulteacherList}</ul>
          </div>
          </div>
        </div>
      `;

      document>
        </div>
.getElementById("btnPDF").disabled      `;

      document.getElementById("btnPDF").disabled = false;
      document = false;
      document.getElementById(".getElementById("btnODT").disabledbtnODT").disabled = false;
    }

 = false;
    }

    // åŒ¯å‡º PDFï¼ˆä»¥ DOM â†’ å½±åƒ â†’ PDFï¼Œä¸­æ–‡å­—ç„¡    // åŒ¯å‡º PDFï¼ˆä»¥ DOM â†’ å½±åƒ â†’ PDFï¼Œä¸­æ–‡å­—ç„¡å­—å‹å•é¡Œï¼‰
    functionå­—å‹å•é¡Œï¼‰
    function exportPDF() {
      exportPDF() {
      const element = document.getElement const element = document.getElementById("output");
ById("output");
      if (!element      if (!element || !element.inner || !element.innerText.trim()) return;
      const optText.trim()) return;
      const opt = {
        margin = {
        margin:       10,
       :       10,
        filename:     ' filename:     'å­¸ç«¥å»ºè­°å ±å‘Š.pdf',
       å­¸ç«¥å»ºè­°å ±å‘Š.pdf',
        image:        { image:        { type: 'jpeg', quality type: 'jpeg', quality: 0.98 },
       : 0.98 },
        html2canvas:  { html2canvas:  { scale: 2, useCORS scale: 2, useCORS: true },
        jsPDF:        {: true },
        jsPDF:        { unit: 'mm', format unit: 'mm', format: 'a4', orientation: 'a4', orientation: 'portrait' }
     : 'portrait' }
      };
      html2pdf };
      html2pdf().set(opt).from().set(opt).from(element).save();
(element).save();
    }

    // åŒ¯å‡º    }

    // åŒ¯å‡º ODTï¼ˆå»ºç«‹æœ€å° ODF çµæ§‹ ODTï¼ˆå»ºç«‹æœ€å° ODF çµæ§‹ï¼šmimetypeã€contentï¼šmimetypeã€content.xmlã€manifest.xml.xmlã€manifest.xmlï¼‰
    function xmlï¼‰
    function xmlEscape(str) {
      return String(strEscape(str) {
      return String(str).replace(/&/g,").replace(/&/g,"&amp;").replace(/&amp;").replace(/</g,"&lt;").replace</g,"&lt;").replace(/>/g,"&gt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").(/"/g,"&quot;").replace(/'/g,"&aposreplace(/'/g,"&apos;");
    }

    function buildODTContent;");
    }

    function buildODTContent() {
      const() {
      const selected = getSelected selected = getSelected();
      const header();
      const header = formatHeaderLine = formatHeaderLine();
      const title();
      const title = "å­¸ç«¥ç…§è­·èˆ‡æ•™å­¸å»ºè­°";

 = "å­¸ç«¥ç…§è­·èˆ‡æ•™å­¸å»ºè­°";

      const lines = [];
      lines      const lines.push(`<text:p>${xmlEscape(title)}</ = [];
      lines.push(`<text:p>${xmlEscape(title)}</text:p>`);
     text:p>`);
      lines.push(`<text:p>${xmlEscape(header lines.push(`<text:p>${xmlEscape(header.human)}</text:p>`);
      lines.human)}</text:p>`);
      lines.push(`<text:p></.push(`<text:p></text:p>`);
     text:p>`);
      lines.push(`<text lines.push(`<text:p>å®¶é•·ç…§è­·å»ºè­°ï¼ˆå…± ${selected:p>å®¶é•·ç…§è­·å»ºè­°ï¼ˆå…± ${selected.length} æ¢ï¼‰</text.length} æ¢ï¼‰</text:p>`);
      selected.forEach(s => {
:p>`);
      selected.forEach(s => {
        lines.push        lines.push(`<text:p>ãƒ»[${xmlEscape(s.category)}] ${(`<text:p>ãƒ»[${xmlEscape(s.category)}] ${xmlEscape(s.labelxmlEscape(s.label)}</text:p>`);
       )}</text:p>`);
        lines.push(`<text lines.push(`<text:p>ã€€å»ºè­°ï¼š${xmlEscape(s.parent)}</text:p>ã€€å»ºè­°ï¼š${xmlEscape:p>`);
      });
(s.parent)}</text:p>`);
      });
      lines.push(`<text:p></text      lines.push(`<text:p></text:p>`);
      lines:p>`);
      lines.push(`<text:p>æ•™å¸«.push(`<text:p>æ•™å¸«è¼”å°å»ºè­°ï¼ˆå…± ${selectedè¼”å°å»ºè­°ï¼ˆå…± ${selected.length} æ¢ï¼‰</text.length} æ¢ï¼‰</text:p>`);
      selected:p>`);
      selected.forEach(s => {
.forEach(s => {
        lines.push        lines.push(`<text:p>ãƒ»[${xmlEscape(s.category)}] ${(`<text:p>ãƒ»[${xmlEscape(s.category)}] ${xmlEscape(s.labelxmlEscape(s.label)}</text:p>`);
       )}</text:p>`);
        lines.push(`<text lines.push(`<text:p>ã€€å»ºè­°ï¼š${xmlEscape:p>ã€€å»ºè­°ï¼š${xmlEscape(s.teacher)}</text(s.teacher)}</text:p>`);
      });

      const content:p>`);
      });

      const contentXML =
`<?xml versionXML =
`<?xml version="1.0" encoding="="1.0" encoding="UTF-8"?>
<officeUTF-8"?>
<office:document-content:document-content
  xmlns:office="
  xmlns:office="urn:oasis:names:urn:oasis:names:tc:opendocument:tc:opendocument:xmlns:office:1.0xmlns:office:1.0"
  xmlns:text=""
  xmlns:text="urn:oasis:names:urn:oasis:names:tc:opendocument:tc:opendocument:xmlns:text:1.0"
xmlns:text:1.0"
  xmlns:style="urn  xmlns:style="urn:oasis:names:tc:opendocument:xmlns:oasis:names:tc:opendocument:xmlns:style:1.0"
  xmlns:style:1.0"
  xmlns:fo="urn:oasis:n:fo="urn:oasis:names:tc:opendocumentames:tc:opendocument:xmlns:xsl-fo-compatible:xmlns:xsl-fo-compatible:1.0"
  office:version:1.0"
  office:version="1.2">
  <office="1.2">
  <office:body>
    <office:body>
    <office:text>
      ${lines:text>
      ${lines.join("\n      ".join("\n      ")}
    </office:text>
  </office:body)}
    </office:text>
  </office:body>
</office:document>
</office:document-content>`;
     -content>`;
      return contentXML;
    }

    async return contentXML;
    }

    async function exportODT() {
      const function export selected = getSelectedODT() {
      const selected = getSelected();
      if (selected();
      if (selected.length === 0) return.length === 0) return;

      const zip;

      const zip = new JSZip();
 = new JSZip();
      // ODT è¦ç¯„è¦æ±‚      // ODT è¦ç¯„è¦æ±‚ mimetype æª”æ¡ˆéœ€ç„¡å£“ç¸® mimetype æª”æ¡ˆéœ€ç„¡å£“ç¸®ï¼Œä¸”æ”¾åœ¨ç¬¬ä¸€å€‹
      zipï¼Œä¸”æ”¾åœ¨ç¬¬ä¸€å€‹
      zip.file("mimetype",.file("mimetype", "application/vnd "application/vnd.oasis.opendocument.oasis.opendocument.text", { compression.text", { compression: "STORE" });

      const contentXML = buildODTContent: "STORE" });

      const contentXML();
      zip.file = buildODTContent();
      zip.file("content.xml", content("content.xml", contentXML);

      constXML);

      const manifestXML =
` manifestXML =
`<?xml version="1<?xml version="1.0" encoding="UTF.0" encoding="UTF-8"?>
<manifest:manifest xmlns:manifest-8"?>
<manifest:manifest xmlns:manifest="urn:oasis:names="urn:oasis:names:tc:opendocument:xmlns:manifest::tc:opendocument:xmlns:manifest:1.0" manifest:version1.0" manifest:version="1.2">
  <manifest="1.2">
  <manifest:file-entry manifest:file-entry manifest:full-path="/" manifest:full-path="/" manifest:media-type="application/vnd.oasis.opend:media-type="application/vnd.oasis.opendocument.text"/>
  <manifest:fileocument.text"/>
  <manifest:file-entry manifest:full-path="content-entry manifest:full-path="content.xml" manifest:media.xml" manifest:media-type="text/xml"/>
-type="text/xml"/>
</manifest:manifest</manifest:manifest>`;
      zip.folder>`;
      zip.folder("META-INF").file("manifest.xml",("META-INF").file manifestXML);

      const blob("manifest.xml", manifestXML);

      const blob = await zip.generateAsync({
        type = await zip.generateAsync({
        type: "blob",
       : "blob",
        compression: "DE compression: "DEFLATE"
      });
      const a = documentFLATE"
      });
      const a = document.createElement("a");
      a.href.createElement("a");
      a.href = URL.createObject = URL.createObjectURL(blob);
     URL(blob);
      a.download = "å­¸ a.download = "å­¸ç«¥å»ºè­°å ±å‘Š.odt";
     ç«¥å»ºè­°å ±å‘Š.odt";
      document.body.append document.body.appendChild(a);
      aChild(a);
      a.click();
      set.click();
      setTimeout(() => {
Timeout(() => {
        URL.revoke        URL.revokeObjectURL(a.hrefObjectURL(a.href);
        a.remove);
        a.remove();
      }, 0);
();
      }, 0);
    }

    // ç¶å®š    }

    // ç¶å®šäº‹ä»¶
    document.addEventListener("DOMContentLoaded", () => {
äº‹ä»¶
    document.addEventListener("DOMContentLoaded", () => {
      renderForm();
      document      renderForm();
      document.getElementById(".getElementById("btnGenerate").addbtnGenerate").addEventListener("click", generateOutput);
      documentEventListener("click", generateOutput);
      document.getElementById(".getElementById("btnClear").addEventbtnClear").addEventListener("click",Listener("click", () => {
        () => {
        document.querySelector document.querySelectorAll('#formArea inputAll('#formArea input[type="checkbox"]').forEach(chk => chk.checked = false[type="checkbox"]').forEach(chk => chk);
        document.getElementById(".checked = false);
        documentoutput").innerHTML.getElementById("output").innerHTML = "";
        document = "";
        document.getElementById(".getElementById("btnPDF").disabledbtnPDF").disabled = true;
        = true;
        document.getElement document.getElementById("btnODT").disabledById("btnODT").disabled = true;
      });
 = true;
      });
      document.get      document.getElementById("btnElementById("btnPDF").addEventListenerPDF").addEventListener("click", export("click", exportPDF);
      document.getElementById("btnODT").addEventListener("click",PDF);
      document.getElementById("btnODT").addEventListener("click", exportODT);
    exportODT);
    });
  </script>
</body>
</html>
 });
  </script>
</body>
</html>
