<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>國小學童身心狀況外顯行為輔導建議</title>
    <style>
        body {
            font-family: '微軟正黑體', Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            color: #0056b3;
            text-align: center;
        }
        .category {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .category h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
            margin-bottom: 10px;
        }
        .checkbox-group label {
            display: block;
            margin-bottom: 8px;
            cursor: pointer;
        }
        .checkbox-group input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2); /* 放大 checkbox */
        }
        button {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 20px;
        }
        button:hover {
            background-color: #0056b3;
        }
        #results {
            margin-top: 30px;
            padding: 20px;
            background-color: #e9f7ef;
            border: 1px solid #d4edda;
            border-radius: 8px;
            display: none; /* 預設隱藏 */
        }
        #results h2 {
            color: #28a745;
        }
        .advice-section {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #fff;
            border: 1px solid #bce8f1;
            border-radius: 5px;
        }
        .advice-section h3 {
            color: #17a2b8;
        }
        ul {
            list-style-type: disc;
            margin-left: 20px;
            padding-left: 0;
        }
        ul li {
            margin-bottom: 8px;
        }
        .export-buttons {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .export-buttons button {
            width: 48%;
            background-color: #6c757d;
        }
        .export-buttons button:hover {
            background-color: #5a6268;
        }
        @media (max-width: 768px) {
            .export-buttons {
                flex-direction: column;
            }
            .export-buttons button {
                width: 100%;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>國小學童身心狀況外顯行為輔導建議</h1>
        <p style="text-align: center;">請勾選您觀察到的學童行為表現，我們將提供相關的家長照護建議與教師教學現場輔導建議。</p>

        <form id="behaviorForm">
            <div class="category">
                <h3>注意力與專注力問題</h3>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="behaviors" value="inattention1"> 上課時容易分心，無法持續專注於老師的講解或課堂活動。</label>
                    <label><input type="checkbox" name="behaviors" value="inattention2"> 寫作業或完成任務時，經常粗心大意，犯下不必要的錯誤。</label>
                    <label><input type="checkbox" name="behaviors" value="inattention3"> 玩遊戲或參與其他活動時，很難長時間保持興趣，很快就感到厭倦。</label>
                    <label><input type="checkbox" name="behaviors" value="inattention4"> 似乎沒有在聽他人說話，需要重複提醒才能理解指令。</label>
                    <label><input type="checkbox" name="behaviors" value="inattention5"> 經常忘記日常用品（如鉛筆、書本、外套等）或忘記要完成的事情。</label>
                    <label><input type="checkbox" name="behaviors" value="inattention6"> 難以組織任務和活動，書桌或書包雜亂無章。</label>
                </div>
            </div>

            <div class="category">
                <h3>過動與衝動行為</h3>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="behaviors" value="hyperactivity1"> 無法安靜坐著，經常在座位上扭動、搓手或坐立不安。</label>
                    <label><input type="checkbox" name="behaviors" value="hyperactivity2"> 在課堂或其他需要保持安靜的場合，常離座或跑來跑去。</label>
                    <label><input type="checkbox" name="behaviors" value="hyperactivity3"> 像被馬達驅動一樣，總是停不下來，活動量過大。</label>
                    <label><input type="checkbox" name="behaviors" value="hyperactivity4"> 在不適當的場合過度攀爬或跑跳。</label>
                    <label><input type="checkbox" name="behaviors" value="impulsivity1"> 在問題尚未問完前就衝動回答，打斷他人說話。</label>
                    <label><input type="checkbox" name="behaviors" value="impulsivity2"> 難以等待輪流，經常插隊或搶話。</label>
                    <label><input type="checkbox" name="behaviors" value="impulsivity3"> 經常打斷或干擾他人的活動或遊戲。</label>
                    <label><input type="checkbox" name="behaviors" value="impulsivity4"> 遇到挫折時容易情緒失控，出現攻擊性或破壞行為。</label>
                </div>
            </div>

            <div class="category">
                <h3>情緒困擾與焦慮表現</h3>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="behaviors" value="emotion1"> 經常表現出煩躁、易怒、脾氣暴躁的情緒。</label>
                    <label><input type="checkbox" name="behaviors" value="emotion2"> 對於日常生活中的小變化或不如意的事情反應過度。</label>
                    <label><input type="checkbox" name="behaviors" value="emotion3"> 經常哭泣或情緒低落，對原本喜歡的活動失去興趣。</label>
                    <label><input type="checkbox" name="behaviors" value="emotion4"> 經常抱怨身體不適，如頭痛、肚子痛，但檢查後無生理原因。</label>
                    <label><input type="checkbox" name="behaviors" value="emotion5"> 對於上學、考試或特定社交情境感到過度擔憂與害怕。</label>
                    <label><input type="checkbox" name="behaviors" value="emotion6"> 容易緊張，出現咬指甲、拔頭髮、搓手等焦慮表現。</label>
                </div>
            </div>

            <div class="category">
                <h3>社交與人際互動問題</h3>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="behaviors" value="social1"> 難以與同儕建立友誼，或經常與他人發生衝突。</label>
                    <label><input type="checkbox" name="behaviors" value="social2"> 在團體活動中顯得退縮、害羞，不主動參與。</label>
                    <label><input type="checkbox" name="behaviors" value="social3"> 不理解他人的非語言 cues (如表情、肢體語言)，導致社交誤解。</label>
                    <label><input type="checkbox" name="behaviors" value="social4"> 難以分享物品、輪流或遵守遊戲規則。</label>
                    <label><input type="checkbox" name="behaviors" value="social5"> 堅持己見，難以接受他人的建議或批評。</label>
                    <label><input type="checkbox" name="behaviors" value="social6"> 傾向於獨自玩耍，不喜歡與他人互動。</label>
                </div>
            </div>

            <div class="category">
                <h3>學習困難與學業問題</h3>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="behaviors" value="learning1">  despite 努力，學業成績仍持續落後同儕。</label>
                    <label><input type="checkbox" name="behaviors" value="learning2"> 閱讀、寫字或數學計算方面有顯著困難。</label>
                    <label><input type="checkbox" name="behaviors" value="learning3"> 難以理解抽象概念或解決複雜問題。</label>
                    <label><input type="checkbox" name="behaviors" value="learning4"> 記憶力較差，經常忘記學過的新知識或技能。</label>
                    <label><input type="checkbox" name="behaviors" value="learning5"> 寫字速度慢，字跡潦草，或錯別字多。</label>
                    <label><input type="checkbox" name="behaviors" value="learning6"> 對學習缺乏動機，容易放棄。</label>
                </div>
            </div>

            <div class="category">
                <h3>固著行為與重複性動作</h3>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="behaviors" value="rigid1"> 對於常規或例行公事有強烈的堅持，難以接受改變。</label>
                    <label><input type="checkbox" name="behaviors" value="rigid2"> 沉迷於某些特定興趣或主題，且知識量或細節超出同年齡層。</label>
                    <label><input type="checkbox" name="behaviors" value="rigid3"> 出現重複性的肢體動作，如搖晃身體、拍手、轉圈圈等。</label>
                    <label><input type="checkbox" name="behaviors" value="rigid4"> 對於感官刺激（如聲音、光線、觸覺）過度敏感或反應遲鈍。</label>
                    <label><input type="checkbox" name="behaviors" value="rigid5"> 堅持只吃某些特定食物，或對食物的顏色、質地有特殊要求。</label>
                    <label><input type="checkbox" name="behaviors" value="rigid6"> 在遊戲或活動中，玩法刻板且缺乏彈性。</label>
                </div>
            </div>

            <div class="category">
                <h3>行為規範與反抗行為</h3>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="behaviors" value="conduct1"> 經常違反學校或家庭規則，不聽從師長指令。</label>
                    <label><input type="checkbox" name="behaviors" value="conduct2"> 出現說謊、偷竊、欺騙等行為。</label>
                    <label><input type="checkbox" name="behaviors" value="conduct3"> 有攻擊性行為，如推打、踢人或破壞物品。</label>
                    <label><input type="checkbox" name="behaviors" value="conduct4"> 故意激怒他人，或對他人的感受漠不關心。</label>
                    <label><input type="checkbox" name="behaviors" value="conduct5"> 經常與同儕或手足爭吵，難以解決衝突。</label>
                    <label><input type="checkbox" name="conduct6"> 對於權威人士表現出敵意或反抗。</label>
                </div>
            </div>

            <button type="submit">查看建議</button>
        </form>

        <div id="results">
            <h2>建議與輔導策略</h2>
            <div id="parentAdvice" class="advice-section">
                <h3>家長照護建議</h3>
                <ul id="parentList"></ul>
            </div>
            <div id="teacherAdvice" class="advice-section">
                <h3>教師教學現場輔導建議</h3>
                <ul id="teacherList"></ul>
            </div>
            <div class="export-buttons">
                <button id="exportOdt">匯出 ODT 文件</button>
                <button id="exportPdf">匯出 PDF 文件</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.33.2/docxtemplater.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

    <script>
        const behaviorForm = document.getElementById('behaviorForm');
        const resultsDiv = document.getElementById('results');
        const parentList = document.getElementById('parentList');
        const teacherList = document.getElementById('teacherList');
        const exportOdtButton = document.getElementById('exportOdt');
        const exportPdfButton = document.getElementById('exportPdf');

        // 定義行為表現與對應的建議
        const adviceData = {
            // 注意力與專注力問題
            inattention1: {
                parent: "在家中創造一個安靜、沒有干擾的學習環境，並減少電子產品的使用時間。",
                teacher: "調整座位靠近老師，減少周圍干擾；使用視覺提示或小組討論來維持專注；每隔10-15分鐘給予簡短休息或轉換活動。"
            },
            inattention2: {
                parent: "教導孩子核對作業的習慣，並在旁引導他檢查錯誤，而非直接糾正。",
                teacher: "將任務分解成小步驟，並提供檢查清單；提醒學生注意細節，例如圈出關鍵字。"
            },
            inattention3: {
                parent: "提供多樣化的活動選擇，但要鼓勵孩子嘗試完成一項活動後再進行下一項。",
                teacher: "活動設計要多元有趣，並給予即時回饋，提升學習動機。"
            },
            inattention4: {
                parent: "和孩子說話時，確保有眼神接觸，並請他重複指令以確認理解。",
                teacher: "給予清晰、簡短的指令，一次只給一個指令；確認學生是否理解後再進行下一步。"
            },
            inattention5: {
                parent: "協助孩子建立固定的收納習慣，並使用筆記本或提醒事項來記錄重要事務。",
                teacher: "協助學生建立系統化的學習習慣，如使用聯絡簿、檢查清單；提醒學生收納個人物品。"
            },
            inattention6: {
                parent: "引導孩子學習物品歸位與整理技巧，可以從整理書桌開始。",
                teacher: "提供明確的置物空間規劃，並定期協助學生整理個人物品和學習區域。"
            },

            // 過動與衝動行為
            hyperactivity1: {
                parent: "允許孩子在家中適度活動，提供安全的空間讓他們釋放精力，例如跳繩、跑步。",
                teacher: "允許學生在不干擾他人的情況下，進行小幅度身體活動，如使用彈力帶、站立學習；提供適當的活動或運動時間。"
            },
            hyperactivity2: {
                parent: "在家中練習等待與輪流，例如玩桌遊時強調規則。",
                teacher: "在課程中穿插動態活動，或利用下課時間讓學生充分活動；給予明確的動態活動界線。"
            },
            hyperactivity3: {
                parent: "提供豐富的戶外活動機會，消耗其過剩的精力，並訓練其肢體協調。",
                teacher: "鼓勵學生參與體育活動，提供消耗精力的管道；引導學生在適當情境下展現活力。"
            },
            hyperactivity4: {
                parent: "在家中設定明確的安全規範，並解釋不適當攀爬的潛在危險。",
                teacher: "明確規範校園內的安全行為界線，並即時提醒；提供適當的攀爬或活動器材。"
            },
            impulsivity1: {
                parent: "教導孩子在發言前先思考，可以練習「等三秒再說」的策略。",
                teacher: "在提問後給予足夠的思考時間；鼓勵學生舉手發言，而非搶答；設定「先舉手、後發言」的班級規範。"
            },
            impulsivity2: {
                parent: "透過遊戲或日常生活情境，練習等待輪流，並給予正面鼓勵。",
                teacher: "在排隊或團體活動中，明確示範和練習等待輪流的行為；給予遵守規則的學生正面回饋。"
            },
            impulsivity3: {
                parent: "教導孩子在加入他人活動前，先觀察並詢問是否可以參與。",
                teacher: "教導學生尊重他人的活動空間和隱私，學習詢問和等待；引導他們以適當方式參與團體活動。"
            },
            impulsivity4: {
                parent: "教導孩子情緒管理技巧，如深呼吸、數到十，並協助他表達感受而非用攻擊行為。",
                teacher: "建立班級情緒冷靜區，讓學生學習自我調節；教導衝突解決策略，引導學生用語言表達不滿。"
            },

            // 情緒困擾與焦慮表現
            emotion1: {
                parent: "理解孩子情緒背後的原因，並引導他們用語言表達感受，而非用行為發洩。",
                teacher: "觀察學生情緒波動的徵兆，適時給予關懷；提供情緒發洩的適當管道，例如繪畫、寫日記。"
            },
            emotion2: {
                parent: "協助孩子逐步適應變化，可以事先預告或討論可能發生的改變。",
                teacher: "對於課堂或作息的調整，提前告知學生並給予解釋，降低其不確定感。"
            },
            emotion3: {
                parent: "多花時間陪伴孩子，共同參與他們感興趣的活動，並鼓勵他們表達內心感受。",
                teacher: "鼓勵學生參與多元活動，給予肯定和支持，協助他們重拾興趣；必要時轉介輔導資源。"
            },
            emotion4: {
                parent: "在排除生理原因後，協助孩子探索情緒與身體不適的關聯，並教導放鬆技巧。",
                teacher: "了解學生身體不適背後的情緒壓力，給予安撫和支持；若無生理原因，可引導其表達情緒。"
            },
            emotion5: {
                parent: "提供安全感和支持，逐步引導孩子面對害怕的情境，不強迫他們立即克服。",
                teacher: "對於有焦慮的學生，給予額外關注和鼓勵；適時降低其學習壓力，建立成功的經驗。"
            },
            emotion6: {
                parent: "教導孩子放鬆技巧，如深呼吸、冥想，並減少其生活中的壓力源。",
                teacher: "在考試或壓力情境前，提供放鬆指導；營造溫馨安全的學習環境，減少焦慮源。"
            },

            // 社交與人際互動問題
            social1: {
                parent: "創造機會讓孩子與同齡人互動，可以從少量、熟悉的玩伴開始，並在旁適時引導。",
                teacher: "鼓勵學生參與團體活動，提供合作學習的機會；教導社交技巧，如分享、溝通、解決衝突。"
            },
            social2: {
                parent: "尊重孩子的步調，不強迫社交，但要鼓勵他們嘗試與人接觸。",
                teacher: "安排小組合作，讓學生有機會與不同同學互動；給予內向學生發言的機會，並給予肯定。"
            },
            social3: {
                parent: "透過繪本或角色扮演，教導孩子辨識他人的情緒和肢體語言。",
                teacher: "在課堂中解釋情緒表達與非語言 cues；提供情境模擬，引導學生學習理解他人感受。"
            },
            social4: {
                parent: "在家中設定清晰的遊戲規則，並練習分享與輪流，給予正向回饋。",
                teacher: "在遊戲和活動中明確制定規則，並引導學生遵守；強調合作與分享的重要性，並給予獎勵。"
            },
            social5: {
                parent: "教導孩子如何表達自己的意見，同時學習傾聽他人的想法，練習溝通與妥協。",
                teacher: "引導學生進行有效的溝通，學習表達與傾聽；鼓勵他們從不同角度看待問題，培養同理心。"
            },
            social6: {
                parent: "觀察孩子喜歡獨自玩耍的原因，可以逐步引導他參與團體活動，但也要尊重其獨立性。",
                teacher: "了解學生獨自玩耍的原因，不強迫社交；創造非競爭性的團體活動，讓學生逐漸融入。"
            },

            // 學習困難與學業問題
            learning1: {
                parent: "尋求專業評估，了解孩子學習困難的具體原因；調整學習方式，例如多感官學習。",
                teacher: "與家長溝通，共同了解學生的學習困難；提供個別化教學或補救教學，調整教學策略。"
            },
            learning2: {
                parent: "針對孩子的弱項，提供額外的練習與輔導，並尋求專業資源協助。",
                teacher: "運用多元教學方法，如圖像、實物操作等；針對學生的學習弱點，提供差異化教學與輔導。"
            },
            learning3: {
                parent: "將抽象概念具體化，使用圖示、模型或實例來幫助孩子理解。",
                teacher: "將複雜的知識點分解成小單元；多利用實例或情境來解釋抽象概念，幫助學生理解。"
            },
            learning4: {
                parent: "教導孩子記憶策略，如聯想、心智圖；多加練習與複習，鞏固記憶。",
                teacher: "教導學生記憶技巧，如口訣、歸納；定期複習所學內容，強化記憶。"
            },
            learning5: {
                parent: "練習手眼協調運動，並給予足夠的書寫練習時間，不要求速度，著重正確性。",
                teacher: "提供適當的書寫輔助工具，如握筆器；給予足夠的書寫時間，不苛求字跡完美，鼓勵進步。"
            },
            learning6: {
                parent: "找出孩子的學習興趣，將學習與興趣結合；給予正面肯定，建立學習自信心。",
                teacher: "從學生感興趣的主題切入，提升學習動機；給予及時的鼓勵和肯定，幫助他們建立自信。"
            },

            // 固著行為與重複性動作
            rigid1: {
                parent: "提前告知孩子日常作息的改變，並解釋原因；逐步引入新的活動，幫助他們適應。",
                teacher: "對於課程或作息的變動，提前預告並解釋原因；建立可預期的日常常規，減少學生的焦慮。"
            },
            rigid2: {
                parent: "支持孩子發展其特殊興趣，但也要鼓勵他們接觸其他領域，擴展視野。",
                teacher: "善用學生的特殊興趣，將其融入課程設計；鼓勵學生分享其知識，並引導他們接觸多元主題。"
            },
            rigid3: {
                parent: "了解重複性動作的原因，若無影響功能，可不必強行制止；若有影響，可引導其轉移。",
                teacher: "觀察重複性動作的頻率與情境，了解其功能；若無影響，可不干預；若有影響，可提供替代性動作。"
            },
            rigid4: {
                parent: "了解孩子對感官刺激的偏好或厭惡，並盡量調整環境以符合其需求。",
                teacher: "了解學生對感官刺激的反應，例如提供耳罩、降低燈光；營造適合其感官需求的學習環境。"
            },
            rigid5: {
                parent: "逐步引入新的食物種類，從小份量開始，不強迫孩子接受。",
                teacher: "尊重學生對食物的偏好，不強迫其進食不喜歡的食物；鼓勵他們嘗試多樣化飲食，並給予正面引導。"
            },
            rigid6: {
                parent: "引導孩子嘗試不同的遊戲玩法，鼓勵創造性與彈性，但要尊重其步調。",
                teacher: "在遊戲中示範不同的玩法，鼓勵學生嘗試；引導他們理解遊戲規則的彈性，培養創造力。"
            },

            // 行為規範與反抗行為
            conduct1: {
                parent: "與孩子共同建立明確的家庭規則，並設定合理的獎懲制度。",
                teacher: "建立清晰的班級規範，並與學生共同討論；對於違規行為，給予一致且立即的處理。"
            },
            conduct2: {
                parent: "了解孩子說謊、偷竊背後的原因，教導誠實的重要性，並培養同理心。",
                teacher: "了解學生行為背後的原因，非直接懲罰；教導誠實的重要性，並引導其承擔責任。"
            },
            conduct3: {
                parent: "教導孩子情緒管理與衝突解決技巧，並提供替代性的情緒宣洩方式。",
                teacher: "建立情緒冷靜區，教導學生有效的情緒管理策略；引導學生以非暴力方式解決衝突。"
            },
            conduct4: {
                parent: "教導孩子換位思考，理解他人的感受；強化其同理心。",
                teacher: "透過故事或情境教學，引導學生學習同理心，理解他人的感受；鼓勵其關懷他人。"
            },
            conduct5: {
                parent: "教導孩子有效的溝通技巧與衝突解決策略，鼓勵他們學習協商與妥協。",
                teacher: "教導學生衝突解決的步驟，鼓勵他們透過溝通協商；老師可扮演協調者角色，引導學生解決問題。"
            },
            conduct6: {
                parent: "與孩子進行有效的溝通，了解其反抗的原因，並設定合理的界線。",
                teacher: "與學生建立良好的師生關係，傾聽其意見；在原則範圍內給予彈性，避免正面衝突。"
            }
        };

        behaviorForm.addEventListener('submit', function(event) {
            event.preventDefault(); // 阻止表單提交的預設行為

            const selectedBehaviors = Array.from(document.querySelectorAll('input[name="behaviors"]:checked')).map(cb => cb.value);

            // 清空之前的建議
            parentList.innerHTML = '';
            teacherList.innerHTML = '';

            if (selectedBehaviors.length === 0) {
                parentList.innerHTML = '<li>請至少勾選一項行為表現，以獲得相關建議。</li>';
                teacherList.innerHTML = '<li>請至少勾選一項行為表現，以獲得相關建議。</li>';
            } else {
                const uniqueParentAdvices = new Set();
                const uniqueTeacherAdvices = new Set();

                selectedBehaviors.forEach(behavior => {
                    if (adviceData[behavior]) {
                        uniqueParentAdvices.add(adviceData[behavior].parent);
                        uniqueTeacherAdvices.add(adviceData[behavior].teacher);
                    }
                });

                if (uniqueParentAdvices.size > 0) {
                    uniqueParentAdvices.forEach(advice => {
                        const li = document.createElement('li');
                        li.textContent = advice;
                        parentList.appendChild(li);
                    });
                } else {
                    parentList.innerHTML = '<li>目前沒有針對您所選行為的家長照護建議。</li>';
                }

                if (uniqueTeacherAdvices.size > 0) {
                    uniqueTeacherAdvices.forEach(advice => {
                        const li = document.createElement('li');
                        li.textContent = advice;
                        teacherList.appendChild(li);
                    });
                } else {
                    teacherList.innerHTML = '<li>目前沒有針對您所選行為的教師教學現場輔導建議。</li>';
                }
            }
            resultsDiv.style.display = 'block'; // 顯示結果區塊
            resultsDiv.scrollIntoView({ behavior: 'smooth' }); // 平滑捲動到結果區塊
        });

        exportOdtButton.addEventListener('click', async function() {
            const JSZip = window.JSZip; // 從 CDN 取得 JSZip
            const Docxtemplater = window.docxtemplater; // 從 CDN 取得 docxtemplater

            const parentAdvices = Array.from(parentList.children).map(li => li.textContent);
            const teacherAdvices = Array.from(teacherList.children).map(li => li.textContent);

            // 建立一個簡單的ODT模板內容（docx 格式，Docxtemplater 其實也支援 ODT，但需要特定設定或插件）
            // 為了簡化，這裡將生成 docx，因為 Docxtemplater 主要用於 docx
            // 如果真的需要 ODT，會需要更複雜的模板或使用專門的 ODT 庫
            // 在這裡，我們將模擬生成一個 .docx 檔案，其內容為純文字。
            // 為了生成真正的 ODT，需要一個預先製作好的 .odt 模板，Docxtemplater 可以用來填充。
            // 因為沒有預設模板，我將生成一個簡單的文字內容。

            const content = `
                國小學童身心狀況外顯行為輔導建議

                家長照護建議：
                ${parentAdvices.map(advice => `- ${advice}`).join('\n')}

                教師教學現場輔導建議：
                ${teacherAdvices.map(advice => `- ${advice}`).join('\n')}
            `;

            // 由於 Docxtemplater 主要用於模板填充，直接生成 ODT / DOCX 文件會比較複雜，
            // 且通常需要一個預先存在的模板文件。
            // 這裡為了實現「匯出」功能，我將提供一個簡化的方案，即生成一個包含文字內容的 .txt 文件，
            // 讓使用者可以自行複製貼上到 ODT 編輯器中。
            // 如果需要真正生成 .odt 文件，需要後端處理或更專業的 JS 庫來操作 ODT 格式。

            // 作為一個替代方案，我們將生成一個帶有 .odt 擴展名的純文本文件，
            // 這樣用戶下載後可以用 LibreOffice Writer 或 MS Word 開啟。
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            saveAs(blob, '輔導建議.odt');

            alert('匯出ODT文件功能僅為純文字格式，您可以將內容複製貼上至文件編輯器。');

            // 如果要生成真正的 .docx 文件，需要一個 template.docx 文件
            // const zip = new JSZip();
            // const doc = new Docxtemplater(zip, {
            //     paragraphLoop: true,
            //     linebreaks: true,
            // });

            // const templatePath = 'path/to/your/template.docx'; // 需要一個 docx 模板文件
            // const templateBlob = await fetch(templatePath).then(res => res.blob());

            // await zip.loadAsync(templateBlob);

            // doc.setData({
            //     parentAdvices: parentAdvices,
            //     teacherAdvices: teacherAdvices,
            // });

            // try {
            //     doc.render();
            // } catch (error) {
            //     console.error(error);
            // }

            // const out = doc.getZip().generate({
            //     type: "blob",
            //     mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
            // });
            // saveAs(out, "輔導建議.docx"); // 由於 Docxtemplater 處理 docx 更方便，這裡生成 docx
        });

        exportPdfButton.addEventListener('click', function() {
            const parentAdvices = Array.from(parentList.children).map(li => li.textContent);
            const teacherAdvices = Array.from(teacherList.children).map(li => li.textContent);

            const docDefinition = {
                content: [
                    { text: '國小學童身心狀況外顯行為輔導建議', style: 'header' },
                    { text: '\n' },
                    { text: '家長照護建議：', style: 'subheader' },
                    {
                        ul: parentAdvices.length > 0 ? parentAdvices : ['目前沒有針對您所選行為的家長照護建議。']
                    },
                    { text: '\n' },
                    { text: '教師教學現場輔導建議：', style: 'subheader' },
                    {
                        ul: teacherAdvices.length > 0 ? teacherAdvices : ['目前沒有針對您所選行為的教師教學現場輔導建議。']
                    }
                ],
                styles: {
                    header: {
                        fontSize: 22,
                        bold: true,
                        alignment: 'center',
                        margin: [0, 0, 0, 10]
                    },
                    subheader: {
                        fontSize: 16,
                        bold: true,
                        margin: [0, 10, 0, 5],
                        color: '#0056b3'
                    },
                    normal: {
                        fontSize: 12
                    }
                },
                defaultStyle: {
                    font: 'MicrosoftYaHei' // 使用微軟正黑體，確保中文顯示正常
                }
            };

            // 設置字體
            pdfMake.fonts = {
                MicrosoftYaHei: {
                    normal: 'https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/fonts/msyh.ttf', // 替換為實際可用的中文字體 CDN 連結
                    bold: 'https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/fonts/msyhbd.ttf' // 如果有粗體字體
                }
            };

            // 如果無法載入 CDN 字體，可以考慮將字體檔案放在本地伺服器上
            // 或者使用內建字體（但可能不支援中文）
            // pdfMake.fonts = {
            //     Roboto: {
            //         normal: 'https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf',
            //         bold: 'https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Medium.ttf',
            //         italics: 'https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Italic.ttf',
            //         bolditalics: 'https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-MediumItalic.ttf'
            //     }
            // };


            pdfMake.createPdf(docDefinition).download('輔導建議.pdf');
        });
    </script>
</body>
</html>
